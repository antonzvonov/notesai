<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Чат</title>
</head>
<body>
<h1>Чат</h1>
<p><a th:href="@{/projects}">Управление проектами</a></p>
<form method="post" enctype="multipart/form-data" th:action="@{/chat}">
    <select name="projectId">
        <option th:each="p : ${projects}" th:value="${p.id}" th:text="${p.name}"></option>
    </select>
    <input type="text" name="message" placeholder="Сообщение" />
    <input type="file" name="file" />
    <button type="submit">Отправить</button>
</form>
<div th:if="${response}">
    <p th:text="${response}"></p>
    <pre th:if="${fileContent}" th:text="${fileContent}"></pre>
</div>
<h2>История сообщений</h2>
<ul>
    <li th:each="msg : ${messages}">
        <span th:text="${msg.timestamp}"></span> :
        <strong th:text="${msg.message}"></strong>
        <em th:text="${msg.response}"></em>
        <span th:text="${msg.project != null ? msg.project.name : 'Без проекта'}"></span>
    </li>
</ul>
</body>
</html>
